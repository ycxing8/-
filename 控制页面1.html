<!doctype html>
<html>
	<head>
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<meta charset="utf-8" >
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=none">
		<title>主控页面</title>
		<!-- 引入CSS -->
		<link rel="stylesheet" href="身份认证.css">
		<link rel="stylesheet"  href="bootstrap-3.3.7-dist/css/bootstrap.min.css">
		<link rel="stylesheet"  href="bootstrap-3.3.7-dist/css/bootstrapValidator.min.css">
		<!-- 引入jS 在这之前先运行jquery-->
		<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
		<script  src="bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
		<script  src="bootstrap-3.3.7-dist/js/bootstrapValidator.min.js"></script>		
		<!-- 内部样式：背景图片 -->
	</head>
	<body>
	<nav  class="navbar navbar-default">
		<ul class="nav nav-pills navbar-nav">
		<li><a id="username">欢迎您:ro</a></li>
		<li><a id="permission">您的权限:super</a></li>
		<li class="dropdown">
		<a class="dropdown-toggle" data-toggle="dropdown" id="manage-list">管理<span class="caret"></span></a>
		<ul class="dropdown-menu" id="hole-list" >
			<li><a href="#" id="user-manage">用户管理</a></li>
			<li><a href="#" id="device-manage">设备管理</a></li>		
			<li><a href="#" id="device-look">设备监控</a></li>			
		</ul>
		</li>
		<li><a href="#" id="exit">退出登录</a></li>
		</ul>
	</nav>
	
	
	
	<!-- 插入图片 -->
	<div class = "container">
		<div class="row">
			<div class="col-sm-12 col-md-12 col-lg-12">
			<img class="img-responsive" src="背景图/process.jpg" />
			    <div  style="position: absolute; top:10%; left: 1%;">
                    <p><label style="background-color:#00fa00" id="yd-enter-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:24%; left:30%;">
                    <p><label style="background-color:#00fa00" id="yd-back-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:10%; left:40%;">
                    <p><label style="background-color:#00fa00" id="yd-layout-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:34%; left:13%;">
                    <p><label style="background-color:#00fa00" id="m1-out-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:38%; left:23%;">
                    <p><label style="background-color:#00fa00" id="mo1-out-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:49%; left:30%;">
                    <p><label style="background-color:#00fa00" id="mo1-out-p">121.1</label><small>Mpa</small></p>
                </div>
				<div  style="position: absolute; top:83%; left:28%;">
                    <p><label style="background-color:#00fa00" id="m2-out-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:88%; left:28%;">
                    <p><label style="background-color:#00fa00" id="m2-out-p">121.1</label><small>Mpa</small></p>
                </div>
				<div  style="position: absolute; top:93%; left:28%;">
                    <p><label style="background-color:#00fa00" id="m2-out-T">121.1</label><small>度</small></p>
                </div>
				<div  style="position: absolute; top:96%; left:38%;">
                    <p><label style="background-color:#00fa00" id="mo1-qs-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:101%; left:38%;">
                    <p><label style="background-color:#00fa00" id="mo1-qs-p">121.1</label><small>Mpa</small></p>
                </div>
				<div  style="position: absolute; top:80.6%; left:15%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="m1-state"></label>
                </div>
				<div  style="position: absolute; top:54.5%; left:16.3%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf1-state"></label>
                </div>
				<div  style="position: absolute; top:8.9%; left:12.3%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf3-state"></label>
                </div>
				<div  style="position: absolute; top:26.5%; left:23.7%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf2-state"></label>
                </div>
				<div  style="position: absolute; top:8.9%; left:34.7%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf4-state"></label>
                </div>
				<div  style="position: absolute; top:82.7%; left:21.7%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="m2-state"></label>
                </div>
				<div  style="position: absolute; top:85%; left:43%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="kgf3-state"></label>
                </div>
				<div  style="position: absolute; top:8.9%; left:54.2%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf7-state"></label>
                </div>
				<div  style="position: absolute; top:8.9%; left:76.7%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf8-state"></label>
                </div>
				<div  style="position: absolute; top:56.1%; left:58.3%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf5-state"></label>
                </div>
				<div  style="position: absolute; top:28.4%; left:66%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="tjf6-state"></label>
                </div>
				<div  style="position: absolute; top:85.6%; left:85.8%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="kgf6-state"></label>
                </div>
				<div  style="position: absolute; top:82.4%; left:57.6%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="m3-state"></label>
                </div>
				<div  style="position: absolute; top:85.2%; left:64.3%;">
                    <label style="background-color:#ff0000;width:16px;height:16px;-webkit-border-radius:8px" id="m4-state"></label>
                </div>
				<div  style="position: absolute; top:23.7%; left:73.2%;">
                    <p><label style="background-color:#00fa00" id="ed-back-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:10%; left:83.2%;">
                    <p><label style="background-color:#00fa00" id="ed-layout-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:34%; left:56.2%;">
                    <p><label style="background-color:#00fa00" id="m3-out-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:38%; left:66.2%;">
                    <p><label style="background-color:#00fa00" id="mo2-out-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:49%; left:73.2%;">
                    <p><label style="background-color:#00fa00" id="mo2-out-p">121.1</label><small>Mpa</small></p>
                </div>
				<div  style="position: absolute; top:83%; left:72.2%;">
                    <p><label style="background-color:#00fa00" id="m4-out-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:88%; left:72.2%;">
                    <p><label style="background-color:#00fa00" id="m4-out-p">121.1</label><small>Mpa</small></p>
                </div>
				<div  style="position: absolute; top:93%; left:72.2%;">
                    <p><label style="background-color:#00fa00" id="m4-out-T">121.1</label><small>度</small></p>
                </div>
				<div  style="position: absolute; top:96%; left:81.2%;">
                    <p><label style="background-color:#00fa00" id="mo2-qs-flow">121.1</label><small>M3/h</small></p>
                </div>
				<div  style="position: absolute; top:101%; left:81.2%;">
                    <p><label style="background-color:#00fa00" id="mo2-qs-p">121.1</label><small>Mpa</small></p>
				</div>
				<div  style="position: absolute; top:73%; left:16%;">
                    <p><label style="background-color:#00fa00" id="m1-fre">121.1</label><small>Hz</small></p>
				</div>
				<div  style="position: absolute; top:72.3%; left:22.1%;">
                    <p><label style="background-color:#00fa00" id="m2-fre">121.1</label><small>Hz</small></p>
				</div>
				<div  style="position: absolute; top:74.1%; left:57.7%;">
                    <p><label style="background-color:#00fa00" id="m3-fre">121.1</label><small>Hz</small></p>
				</div>
				<div  style="position: absolute; top:75.3%; left:64.2%;">
                    <p><label style="background-color:#00fa00" id="m4-fre">121.1</label><small>Hz</small></p>
				</div>
		</div>
	</div>
	</div>
	</body>
	<script>
	$(document).ready(function(){
		setInterval(flush,4000);
		<!-- 获取用户名和权限 -->
		$.ajax({
		type:"GET",
		url:"http://101.132.126.248:8081/api/user/get_my_message",
		dataType:"json",
		success: function(result){
			document.getElementById("username").innerHTML = "欢迎您:"+result.name;
			document.getElementById("permission").innerHTML = "您的权限:"+result.power;	
		},
		error:function(){
		alert("登录异常")
		}
	});
		<!-- 权限管理 -->
		$("#manage-list").click(function(){
			var power = document.getElementById("permission").innerHTML.split(":")[1];
			if(power == "admin");
			else{
				document.getElementById("hole-list").style.display="none";
				alert("您没有管理员权限");
				}
		});
		<!-- 下拉列表 -->
		$("#user-manage").click(function(){
			var name = document.getElementById("username").innerHTML;
			name = name.split(":")[1];
			url = "用户管理.html" + "?name=";
			url += name;
			window.open(url);
		});
		<!-- 退出登录 -->
		$("#exit").click(function(){
			$.ajax({
				type:"GET",
				dataType:"text",
				url:"http://101.132.126.248:8081/api/user/login_out",
				success:function(result){
					if(result == "OK"){
						alert("退出成功");
						window.location.assign("身份认证.html");
					}
					else {alert("服务器异常"); }
				},
				error:function(){
					alert("退出失败");
				}
			});
		});
		<!-- 刷新数据函数 -->
		function flush(){
			$.ajax({
				type:"POST",
				dataType:"json",
				url:"http://101.132.126.248:8081/api/component/get_by_machine_identifier",
				data:{"machine_identifier":"01"},
				success: function(result){
					var num = Object.keys(result).length;
					for(var i=0;i<num;i++){
						var cell = result[i];
						if(cell.pk.identifier == "F1")
							document.getElementById("m1-out-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F2")
							document.getElementById("m2-out-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F3")
							document.getElementById("mo1-qs-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F4")
							document.getElementById("yd-back-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F5")
							document.getElementById("yd-layout-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F6")
							document.getElementById("m3-out-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F7")
							document.getElementById("m4-out-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F8")
							document.getElementById("mo2-qs-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F9")
							document.getElementById("ed-back-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F10")
							document.getElementById("ed-layout-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F11")
							document.getElementById("yd-enter-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F12")
							document.getElementById("mo1-out-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "F13")
							document.getElementById("mo2-out-flow").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "P1")
							document.getElementById("m2-out-p").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "P2")
							document.getElementById("mo1-out-p").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "P3")
							document.getElementById("mo1-qs-p").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "P4")
							document.getElementById("m4-out-p").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "P5")
							document.getElementById("mo2-out-p").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "P6")
							document.getElementById("mo2-qs-p").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "L1");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "L2");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "L3");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "L4");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "T1")
							document.getElementById("m2-out-T").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "T2")
							document.getElementById("m4-out-T").innerHTML = cell.realTimeData;
						else if(cell.pk.identifier == "T3");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "KGF1");
								<!-- if(cell.status == "N") -->
									<!-- document.getElementById("kgf") -->
						else if(cell.pk.identifier == "KGF2");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "KGF3")
						{
								if(cell.status == "N")
									document.getElementById("kgf3-state").style.background="red";
								else
									document.getElementById("kgf3-state").style.background="#00fa00";
						}
						else if(cell.pk.identifier == "KGF4");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "KGF5");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "KGF6"){
							if(cell.status == "N")
								document.getElementById("kgf6-state").style.background = "red";
							else
								document.getElementById("kgf6-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "KGF7");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "KGF8");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "KGF9");
							<!-- document.getElementById("m1-out-flow").innerHTML = cell.realTimeData; -->
						else if(cell.pk.identifier == "TJF1"){
							if(cell.status == "N")
								document.getElementById("tjf1-state").style.background = "red";
							else
								document.getElementById("tjf1-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF2"){
								if(cell.status == "N")
									document.getElementById("tjf2-state").style.background = "red";
								else
									document.getElementById("tjf2-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF3"){
							if(cell.status == "N")
								document.getElementById("tjf3-state").style.background = "red";
							else
								document.getElementById("tjf3-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF4"){
							if(cell.status == "N")
								document.getElementById("tjf4-state").style.background = "red";
							else
								document.getElementById("tjf4-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF5"){
							if(cell.status == "N")
								document.getElementById("tjf5-state").style.background = "red";
							else
								document.getElementById("tjf5-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF6"){
								if(cell.status == "N")
									document.getElementById("tjf6-state").style.background = "red";
								else
									document.getElementById("tjf6-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF7"){
							if(cell.status == "N")
								document.getElementById("tjf7-state").style.background = "red";
							else
								document.getElementById("tjf7-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "TJF8"){
							if(cell.status == "N")
								document.getElementById("tjf8-state").style.background = "red";
							else
								document.getElementById("tjf8-state").style.background = "#00fa00";
							}
						else if(cell.pk.identifier == "M1"){
							if(cell.status == "N")
								document.getElementById("m1-state").style.background = "red";
							else
								document.getElementById("m1-state").style.background = "#00fa00";
							document.getElementById("m1-fre").innerHTML = cell.realTimeData; 
							}
						else if(cell.pk.identifier == "M2"){
								if(cell.status == "N")
									document.getElementById("m2-state").style.background = "red";
								else
									document.getElementById("m2-state").style.background = "#00fa00";
								document.getElementById("m2-fre").innerHTML = cell.realTimeData;
							}
						else if(cell.pk.identifier == "M3"){
							if(cell.status == "N")
								document.getElementById("m3-state").style.background = "red";
							else
								document.getElementById("m3-state").style.background = "#00fa00";
							document.getElementById("m3-fre").innerHTML = cell.realTimeData;
							}
						else if(cell.pk.identifier == "M4"){
							if(cell.status == "N")
								document.getElementById("m4-state").style.background = "red";
							else
								document.getElementById("m4-state").style.background = "#00fa00";
							document.getElementById("m4-fre").innerHTML = cell.realTimeData;
							}
						<!-- else if(cell.pk.identifier == "M5"){ -->
							<!-- if(cell.status == "N") -->
								<!-- document.getElementById("m5-state").style.background = "red"; -->
							<!-- else -->
								<!-- document.getElementById("m5-state").style.background = "#00fa00"; -->
							<!-- } -->
						else ;
					}
				},
				error: function(){
					alert("数据获取失败");
				}
			});
		}
	});
	</script>
</html>